<html>
<head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <div class="canvas-container">
        <canvas height="400" id="c" width="800"></canvas>
    </div>

    <script src="wasm_exec.js"></script>
    <script>
        // "exports"
        function setTarget() {}
        function resetChip8() {}

        const go = new Go();
        WebAssembly
            .instantiateStreaming(fetch("main.wasm"), go.importObject)
            .then((result) => {
                go.run(result.instance);

                setTarget("c")

                let oReq = new XMLHttpRequest();
                oReq.open("GET", "/roms/games/Space%20Invaders%20%5BDavid%20Winter%5D.ch8", true);
                oReq.responseType = "arraybuffer";

                oReq.onload = function (oEvent) {
                    const arrayBuffer = oReq.response;
                    if (arrayBuffer) {
                        const byteArray = new Uint8Array(arrayBuffer);
                        console.log(byteArray)
                        resetChip8(byteArray)
                    }
                };

                oReq.send(null);
            }
        );
    </script>
</body>
</html>